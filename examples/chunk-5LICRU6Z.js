import{$a as M,E as R,Ha as u,Hb as Y,Ib as G,Kb as J,N as j,Ra as c,Sa as $,Wb as v,Xa as k,a as m,bb as N,fa as z,h as x,jb as H,kb as P,kc as K,m as F,n as L,na as A,oa as B,ob as Q,pa as d,rb as V,ub as X,wa as l,wb as q,xb as U,yc as g}from"./chunk-H5XLUPFI.js";var y=function(i){return i.BeginDrag="BeginDrag",i.Hover="Hover",i.Drop="Drop",i.EndDrag="EndDrag",i}(y||{}),S=class{constructor(n,t){this.type=n,this.item=t,this.event=y.BeginDrag}},w=class{constructor(n,t){this.type=n,this.item=t,this.event=y.Hover}},C=class{constructor(n,t){this.type=n,this.item=t,this.event=y.Drop}},O=class{constructor(n,t){this.type=n,this.item=t,this.event=y.EndDrag}},W=class{constructor(n,t,e){this.store=n,this.actionType=t,this.beginDrag=(r,s)=>{this.store.dispatch(new S(this.actionType,r))},this.hover=(r,s)=>{this.store.dispatch(new w(this.actionType,r))},this.drop=(r,s)=>{this.store.dispatch(new C(this.actionType,r))},this.endDrag=(r,s)=>{this.store.dispatch(new O(this.actionType,r))},e.type!==void 0&&(this.type=e.type),e.accepts!==void 0&&(this.accepts=e.accepts),e.trackBy!==void 0&&(this.trackBy=e.trackBy),e.getList!==void 0&&(this.getList=e.getList),e.canDrag!==void 0&&(this.canDrag=e.canDrag),e.canDrop!==void 0&&(this.canDrop=e.canDrop),e.isDragging!==void 0&&(this.isDragging=e.isDragging),e.createData!==void 0&&(this.createData=e.createData)}};var it=Symbol("SPILLED_LIST_ID");function ft(i,n,t){let e=a=>a?(a.hover={listId:it,index:-1},m({},a)):null,r=new F,s=i.dropTarget(n,{hover:a=>{if(a.canDrop()&&a.isOver({shallow:!0})){let p=e(a.getItem());r.next(p)}else r.next(null)},drop:t.drop&&(a=>{let p=e(a.getItem());a.didDrop()||p&&t.drop?.(p)})||void 0}),h=r.pipe(j(),R(a=>!!a)).subscribe(a=>{a&&t.hover?.(a)});return s.add(h),s}function Z(i){for(let n of i)return!1;return!0}var D=class{constructor(n,t){this.width=n,this.height=t}style(){return{width:this.width+"px",height:this.height+"px"}}},I=function(i){return i.halfway="halfway",i.fixed="fixed",i}(I||{});var T=(()=>{class i{constructor(t,e,r){this.dnd=t,this.el=e,this.cdr=r,this.listId=Math.random().toString(),this.horizontal=!1,this.hoverTrigger=I.halfway,this.childrenSubject$=new L([]),this.children$=this.childrenSubject$,this.subs=new x,this.listSubs=new x,this.target=this.dnd.dropTarget(null,{canDrop:s=>{if(!this.acceptsType(s.getItemType()))return!1;let o=s.getItem();return o?this.getCanDrop(o,s):!1},drop:s=>{let o=s.getItem();return o&&this.getCanDrop(o,s)&&this.spec.drop?.(o,s),{}},hover:s=>{let o=s.getItem();this.children&&Z(this.children)&&o&&this.getCanDrop(o,s)&&s.isOver({shallow:!0})&&this.callHover(o,s,{listId:this.listId,index:0})}},this.subs)}contextFor(t,e){return{data:t,index:e,listId:this.listId,spec:this.spec,horizontal:this.horizontal,hoverTrigger:this.hoverTrigger}}updateSubscription(){if(this.listId!=null&&this.spec&&(this.listSubs&&(this.subs.remove(this.listSubs),this.listSubs.unsubscribe()),this.spec.getList)){let t=this.spec.getList(this.listId);this.listSubs=t?.subscribe(e=>{e&&(this.childrenSubject$.next(e),this.children=e,this.cdr.markForCheck())}),this.subs.add(this.listSubs)}}getCanDrop(t,e,r=!0){return this.spec.canDrop?this.spec.canDrop(t,e):r}callHover(t,e,r){r&&(t.hover=r,t=m({},t)),this.spec.hover?.(t,e)}ngOnInit(){this.updateSubscription(),this.target.setTypes(this.getTargetType())}getTargetType(){return Array.isArray(this.spec.accepts)?this.spec.accepts:this.spec.accepts||this.spec.type}acceptsType(t){if(t==null)return!1;if(Array.isArray(this.spec.accepts))return this.spec.accepts.indexOf(t)!==-1;{let e=this.getTargetType();return t==e}}ngOnChanges({spec:t,listId:e}){e&&this.updateSubscription(),t&&this.updateSubscription(),this.target.setTypes(this.getTargetType())}ngAfterViewInit(){if(this.el)this.target.connectDropTarget(this.el.nativeElement);else throw new Error("dndSortable directive must have ElementRef")}ngOnDestroy(){this.subs.unsubscribe()}static{this.\u0275fac=function(e){return new(e||i)(c(g),c(u),c(v))}}static{this.\u0275dir=d({type:i,selectors:[["","dndSortable",""]],inputs:{listId:"listId",horizontal:"horizontal",spec:"spec",children:"children",hoverTrigger:"hoverTrigger"},exportAs:["dndSortable"],standalone:!0,features:[l]})}}return i})();var tt=Symbol("EXTERNAL_LIST_ID"),rt=(()=>{class i{constructor(t,e){this.dnd=t,this.el=e,this.source=this.dnd.dragSource(null,{canDrag:r=>this.spec.canDrag?this.spec.canDrag(void 0,void 0,r):!0,beginDrag:()=>{if(typeof this.spec.createData!="function")throw new Error("spec.createData must be a function");return{type:this.spec.type,data:this.spec.createData(),hover:{index:-1,listId:tt},isInternal:!1,index:-1,listId:tt,size:this.size()}},endDrag:r=>{let s=r.getItem();s&&this.spec.endDrag?.(s,r)}})}size(){let t=this.el.nativeElement.getBoundingClientRect();return new D(t.width||t.right-t.left,t.height||t.bottom-t.top)}ngOnChanges(){this.source.setType(this.spec.type)}ngOnDestroy(){this.source.unsubscribe()}static{this.\u0275fac=function(e){return new(e||i)(c(g),c(u))}}static{this.\u0275dir=d({type:i,selectors:[["","dndSortableExternal",""]],inputs:{spec:[0,"dndSortableExternal","spec"]},exportAs:["dndSortableExternal"],standalone:!0,features:[l]})}}return i})();var _=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=d({type:i,selectors:[["","dndSortableTemplate",""]],standalone:!0})}}return i})();var st=i=>({$implicit:i});function nt(i,n){i&1&&Q(0)}function ot(i,n){if(i&1&&M(0,nt,1,0,"ng-container",0),i&2){let t=n.$implicit,e=n.$index,r=V();N("ngTemplateOutlet",r.template)("ngTemplateOutletContext",J(2,st,r.contextFor(t,e)))}}var at=(()=>{class i extends T{set renderTemplates(t){t.length>0&&(this.template=t.first)}constructor(t,e,r){super(t,e,r),this.template=null,this.trackById=(s,o)=>this.spec.trackBy(o)}ngAfterContentInit(){if(!this.template)throw new Error('You must provide a <ng-template cardTemplate> as a content child, or with [template]="myTemplateRef"')}ngOnChanges(t){super.ngOnChanges(t)}ngOnInit(){super.ngOnInit()}ngAfterViewInit(){super.ngAfterViewInit()}ngOnDestroy(){super.ngOnDestroy()}static{this.\u0275fac=function(e){return new(e||i)(c(g),c(u),c(v))}}static{this.\u0275cmp=A({type:i,selectors:[["dnd-sortable-list"]],contentQueries:function(e,r,s){if(e&1&&X(s,_,4,$),e&2){let o;q(o=U())&&(r.renderTemplates=o)}},inputs:{template:"template"},standalone:!0,features:[Y([{provide:T,useExisting:i}]),k,l,G],decls:2,vars:0,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,r){e&1&&H(0,ot,1,4,"ng-container",null,r.trackById,!0),e&2&&P(r.children)},dependencies:[K],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}}return i})();function ct(i,n,t,e){let{hover:r}=n,s=i.horizontal?t.width||t.right-t.left:t.height||t.bottom-t.top,h=(i.horizontal?t.left:t.top)+s/2,p=(i.horizontal?e.x:e.y)<h,f;return i.listId===r.listId?i.index<r.index?f=p?i.index:i.index+1:(f=p?i.index-1:i.index,f<0&&(f=0)):f=p?i.index:i.index+1,f}function ht(i){return i.index}function et(i){switch(i){case I.fixed:return ht;default:return ct}}var pt=requestAnimationFrame||(i=>setTimeout(i,0)),dt=(()=>{class i{get data(){return this.context.data}get index(){return this.context.index}get type(){return this.context.spec.type}get listId(){return this.context.listId}get accepts(){let t=this.context.spec;return t?Array.isArray(t.accepts)?t.accepts:t.accepts||t.type:[]}get spec(){return this.context.spec}constructor(t,e){this.dnd=t,this.el=e,this.subs=new x,this.sameIds=(r,s)=>r&&s.data&&this.spec.trackBy(r)===this.spec.trackBy(s.data),this.target=this.dnd.dropTarget(null,{canDrop:()=>!1,hover:r=>{this.hover(r)}},this.subs),this.source=this.dnd.dragSource(null,{canDrag:r=>this.getCanDrag(r),isDragging:r=>this.isDragging(r.getItem()),beginDrag:r=>{let s=this.createItem();return this.spec.beginDrag&&pt(()=>{this.spec.beginDrag?.(s,r)}),s},endDrag:r=>{let s=r.getItem();s&&this.spec.endDrag?.(s,r)}},this.subs),this.isDragging$=this.source.listen(r=>r.isDragging())}createItem(){return{data:this.data,index:this.index,size:this.size(),type:this.type,isInternal:!0,listId:this.listId,hover:{index:this.index,listId:this.listId}}}getCanDrag(t){return this.spec.canDrag?this.spec.canDrag(this.data,this.listId,t):!0}isDragging(t){return this.spec.isDragging?t&&this.spec.isDragging(this.data,t)||!1:t&&this.sameIds(this.data,t)||!1}hover(t){let e=t.getItem(),r=t.getClientOffset();if(e==null||r==null||this.isDragging(e)&&this.index===e.hover.index&&this.listId===e.hover.listId)return;let{hover:s}=e,h=et(this.context.hoverTrigger)(this.context,e,this.rect(),r);if(h<0)throw new Error("@ng-dnd/sortable: Cannot move a card to an index < 0.");if(h!==s.index||this.listId!==s.listId){if(e.hover={index:h,listId:this.listId},this.spec.canDrop&&!this.spec.canDrop(e,t))return;this.spec.hover?.(m({},e),t)}}rect(){if(!this.el)throw new Error("@ng-dnd/sortable: [dndSortableRender] expected to be attached to a real DOM element");return this.el.nativeElement.getBoundingClientRect()}size(){let t=this.rect(),e=t.width||t.right-t.left,r=t.height||t.bottom-t.top;return new D(e,r)}ngOnChanges(){this.target.setTypes(this.accepts),this.source.setType(this.type)}ngOnInit(){this.target.setTypes(this.accepts),this.source.setType(this.type)}ngAfterViewInit(){this.el&&this.target.connectDropTarget(this.el.nativeElement)}ngOnDestroy(){this.subs.unsubscribe()}static{this.\u0275fac=function(e){return new(e||i)(c(g),c(u))}}static{this.\u0275dir=d({type:i,selectors:[["","dndSortableRender",""]],inputs:{context:[0,"dndSortableRender","context"]},exportAs:["dndSortableRender"],standalone:!0,features:[l]})}}return i})();var Gt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=B({type:i})}static{this.\u0275inj=z({})}}return i})();export{I as a,T as b,rt as c,_ as d,at as e,dt as f,y as g,W as h,ft as i,Gt as j};
