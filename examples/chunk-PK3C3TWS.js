import{c as N}from"./chunk-3N5LZPAB.js";import{e as U,f as X}from"./chunk-RVW25ACB.js";import"./chunk-6YLGINRF.js";import{a as Z}from"./chunk-2VD5BHMB.js";import{$a as p,Ab as A,Cb as Y,Ea as _,Ha as T,Ib as f,Jb as L,Kb as Q,Nb as W,Ob as j,Qa as c,Ra as v,Sa as w,bb as m,cb as M,hb as B,jb as I,kb as k,kc as q,lb as r,lc as J,mb as o,na as g,nb as D,ob as F,pa as E,pb as O,qb as R,rb as u,rc as z,sc as G,ub as $,wb as V,wc as H,xa as h,xb as P,ya as x,yc as K,zb as a}from"./chunk-H5XLUPFI.js";var re=t=>({$implicit:t});function oe(t,s){t&1&&F(0)}var b=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275dir=E({type:t,selectors:[["","cardInner",""]],standalone:!0})}}return t})(),te=(()=>{class t{constructor(n,e){this.elRef=n,this.dnd=e,this.beginDrag=new _,this.endDrag=new _,this.handleMove=new _,this.cardSource=this.dnd.dragSource("CARD",{beginDrag:()=>(this.beginDrag.emit(),{id:this.id,index:this.index}),endDrag:i=>{let d=i.didDrop();this.endDrag.emit(d)}}),this.cardTarget=this.dnd.dropTarget("CARD",{hover:i=>{let d=i.getItem().index,l=this.index;if(d===l)return;let C=this.elRef.nativeElement.getBoundingClientRect(),S=(C.bottom-C.top)/2,y=i.getClientOffset().y-C.top;d<l&&y<S||d>l&&y>S||(this.handleMove.emit([d,l]),i.getItem().index=l)}}),this.isDragging$=this.cardSource.listen(i=>i.isDragging()),this.opacity$=this.cardSource.listen(i=>i.isDragging()?.2:1)}moveCard(n,e){this.handleMove.emit([n,e])}ngOnDestroy(){this.cardSource.unsubscribe(),this.cardTarget.unsubscribe()}static{this.\u0275fac=function(e){return new(e||t)(v(T),v(K))}}static{this.\u0275cmp=g({type:t,selectors:[["app-card"]],contentQueries:function(e,i,d){if(e&1&&$(d,b,5,w),e&2){let l;V(l=P())&&(i.cardInnerTemplate=l.first)}},inputs:{card:"card",index:"index",id:"id",text:"text"},outputs:{beginDrag:"beginDrag",endDrag:"endDrag",handleMove:"handleMove"},standalone:!0,features:[f],decls:4,vars:10,consts:[[1,"card",3,"dropTarget","dragSource"],[1,"border"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){e&1&&(r(0,"div",0),W(1,"async"),r(2,"div",1),p(3,oe,1,0,"ng-container",2),o()()),e&2&&(M("opacity",j(1,6,i.opacity$)),m("dropTarget",i.cardTarget)("dragSource",i.cardSource),c(3),m("ngTemplateOutlet",i.cardInnerTemplate)("ngTemplateOutletContext",Q(8,re,i.card)))},dependencies:[H,G,z,q,J],styles:[".card[_ngcontent-%COMP%]{margin-bottom:.25rem;background-color:#fff;cursor:move}.border[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px dashed gray}"],changeDetection:0})}}return t})();function ae(t,s){if(t&1&&(r(0,"span"),a(1),o()),t&2){let n=s.$implicit,e=u(2).item;c(),Y("",e.index+1," ",n.text,"")}}function de(t,s){if(t&1&&(r(0,"app-card",2),p(1,ae,2,2,"span",3),o()),t&2){let n=u().item,e=u();m("card",e.findCard(n.id))}}function se(t,s){if(t&1&&(r(0,"div",0),p(1,de,2,1,"app-card",2),o()),t&2){let n,e=s.$implicit;c(),B((n=e)==="CARD"?1:-1)}}function ce(t,s){if(t&1&&(r(0,"span"),a(1),o()),t&2){let n=s.$implicit;c(),A(n.text)}}function le(t,s){if(t&1){let n=O();r(0,"app-card",4),R("handleMove",function(i){h(n);let d=u();return x(d.moveCard(i))})("beginDrag",function(){h(n);let i=u();return x(i.beginDrag())})("endDrag",function(i){h(n);let d=u();return x(d.endDrag(i))}),p(1,ce,2,1,"span",3),o()}if(t&2){let n=s.$implicit,e=s.$index;m("index",e)("id",n.id)("card",n)}}var ne=(()=>{class t{constructor(){this.cards=[{id:1,text:"Write a cool JS library"},{id:2,text:"Make it generic enough"},{id:3,text:"Write README"},{id:4,text:"Create some examples"},{id:5,text:"Write a glorious Medium post to promote it (note that this element is taller, and far more important, than the others)"},{id:6,text:"Sit back and relax"}],this.origCards=this.cards}findCard(n){return this.cards.find(e=>e.id===n)}beginDrag(){this.origCards=this.cards.slice(0)}endDrag(n){n||(this.cards=this.origCards)}moveCard([n,e]){let i=this.cards[n];this.cards.splice(n,1),this.cards.splice(e,0,i)}tracker(n,e){return e.id}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=g({type:t,selectors:[["basic-sortable"]],standalone:!0,features:[f],decls:5,vars:0,consts:[[1,"sorted"],[3,"index","id","card"],[3,"card"],[4,"cardInner"],[3,"handleMove","beginDrag","endDrag","index","id","card"]],template:function(e,i){e&1&&(r(0,"dnd-preview"),p(1,se,2,1,"ng-template"),o(),r(2,"div",0),I(3,le,2,3,"app-card",1,i.tracker,!0),o()),e&2&&(c(3),k(i.cards))},dependencies:[X,U,te,b],styles:[".sorted[_ngcontent-%COMP%]{max-width:400px}"]})}}return t})();var me=()=>["/sortable","simple"],ie=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=g({type:t,selectors:[["basic-sortable-container"]],standalone:!0,features:[f],decls:34,vars:2,consts:[["path","basic-sortable"],[3,"routerLink"]],template:function(e,i){e&1&&(D(0,"app-example-link",0),r(1,"p"),a(2,"You can make a sortable by:"),o(),r(3,"ul")(4,"li"),a(5,"giving each card a "),r(6,"code"),a(7,"DragSource"),o(),a(8," and a "),r(9,"code"),a(10,"DropTarget"),o(),a(11,";"),o(),r(12,"li"),a(13," determining when you are hovering on the upper or lower half of a neighbouring card using "),r(14,"code"),a(15,"monitor.getClientOffset()"),o(),a(16,"; "),o(),r(17,"li"),a(18," working out when a reordering is necessary by comparing the index with the item in flight's index; "),o(),r(19,"li"),a(20," bubbling up reordering events, and also beginDrag, endDrag and drop events to a component that controls re-rendering the list; and "),o(),r(21,"li"),a(22,"storing a clone of your list to revert to on endDrag, or commit to on drop"),o()(),r(23,"p"),a(24," If that sounds like too much effort, this pattern is made easy and reusable in "),r(25,"code"),a(26,"@ng-dnd/sortable"),o(),a(27,". You can do it without introducing a new component, too. "),o(),r(28,"p"),a(29," You can compare the source code of this example to equivalent using that abstraction, "),r(30,"a",1),a(31,"Simple list"),o(),a(32,". "),o(),D(33,"basic-sortable")),e&2&&(c(30),m("routerLink",L(1,me)))},dependencies:[N,Z,ne],encapsulation:2})}}return t})();var Re=[{path:"",component:ie}];export{Re as routes};
