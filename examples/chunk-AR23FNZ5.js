import{c as q}from"./chunk-AGDH7RBY.js";import{e as G,f as H}from"./chunk-RPUZJCG6.js";import"./chunk-AZZEJM65.js";import{a as K}from"./chunk-T55MMTBF.js";import{Aa as x,Bb as R,Cb as F,Ea as b,Eb as a,Fb as $,Hb as V,Nb as P,Ob as A,Pa as s,Ra as S,Rb as Y,Sb as L,Ya as g,_a as y,ab as p,gb as l,hb as E,ja as _,kc as Q,lc as W,mb as T,ob as w,pb as M,qb as r,rb as o,sb as C,sc as j,ta as f,tb as B,tc as J,ua as h,ub as k,vb as O,wb as m,xc as N,zb as I,zc as z}from"./chunk-C7W2QAC5.js";var te=n=>({$implicit:n});function ne(n,d){n&1&&B(0)}var v=(()=>{class n{static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275dir=y({type:n,selectors:[["","cardInner",""]]})}}return n})(),X=(()=>{class n{constructor(){this.elRef=_(b),this.dnd=_(z),this.beginDrag=new x,this.endDrag=new x,this.handleMove=new x,this.cardSource=this.dnd.dragSource("CARD",{beginDrag:()=>(this.beginDrag.emit(),{id:this.id,index:this.index}),endDrag:t=>{let e=t.didDrop();this.endDrag.emit(e)}}),this.cardTarget=this.dnd.dropTarget("CARD",{hover:t=>{let e=t.getItem().index,i=this.index;if(e===i)return;let c=this.elRef.nativeElement.getBoundingClientRect(),u=(c.bottom-c.top)/2,D=t.getClientOffset().y-c.top;e<i&&D<u||e>i&&D>u||(this.handleMove.emit([e,i]),t.getItem().index=i)}}),this.isDragging$=this.cardSource.listen(t=>t.isDragging()),this.opacity$=this.cardSource.listen(t=>t.isDragging()?.2:1)}moveCard(t,e){this.handleMove.emit([t,e])}ngOnDestroy(){this.cardSource.unsubscribe(),this.cardTarget.unsubscribe()}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-card"]],contentQueries:function(e,i,c){if(e&1&&I(c,v,5,S),e&2){let u;R(u=F())&&(i.cardInnerTemplate=u.first)}},inputs:{card:"card",index:"index",id:"id",text:"text"},outputs:{beginDrag:"beginDrag",endDrag:"endDrag",handleMove:"handleMove"},decls:4,vars:10,consts:[[1,"card",3,"dropTarget","dragSource"],[1,"border"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){e&1&&(r(0,"div",0),Y(1,"async"),r(2,"div",1),p(3,ne,1,0,"ng-container",2),o()()),e&2&&(E("opacity",L(1,6,i.opacity$)),l("dropTarget",i.cardTarget)("dragSource",i.cardSource),s(3),l("ngTemplateOutlet",i.cardInnerTemplate)("ngTemplateOutletContext",A(8,te,i.card)))},dependencies:[N,J,j,Q,W],styles:[".card[_ngcontent-%COMP%]{margin-bottom:.25rem;background-color:#fff;cursor:move}.border[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px dashed gray}"],changeDetection:0})}}return n})();function ie(n,d){if(n&1&&(r(0,"span"),a(1),o()),n&2){let t=d.$implicit,e=m(2).item;s(),V("",e.index+1," ",t.text,"")}}function re(n,d){if(n&1&&(r(0,"app-card",2),p(1,ie,2,2,"span",3),o()),n&2){let t=m().item,e=m();l("card",e.findCard(t.id))}}function oe(n,d){if(n&1&&(r(0,"div",0),p(1,re,2,1,"app-card",2),o()),n&2){let t,e=d.$implicit;s(),T((t=e)==="CARD"?1:-1)}}function ae(n,d){if(n&1&&(r(0,"span"),a(1),o()),n&2){let t=d.$implicit;s(),$(t.text)}}function de(n,d){if(n&1){let t=k();r(0,"app-card",4),O("handleMove",function(i){f(t);let c=m();return h(c.moveCard(i))})("beginDrag",function(){f(t);let i=m();return h(i.beginDrag())})("endDrag",function(i){f(t);let c=m();return h(c.endDrag(i))}),p(1,ae,2,1,"span",3),o()}if(n&2){let t=d.$implicit,e=d.$index;l("index",e)("id",t.id)("card",t)}}var Z=(()=>{class n{constructor(){this.cards=[{id:1,text:"Write a cool JS library"},{id:2,text:"Make it generic enough"},{id:3,text:"Write README"},{id:4,text:"Create some examples"},{id:5,text:"Write a glorious Medium post to promote it (note that this element is taller, and far more important, than the others)"},{id:6,text:"Sit back and relax"}],this.origCards=this.cards}findCard(t){return this.cards.find(e=>e.id===t)}beginDrag(){this.origCards=this.cards.slice(0)}endDrag(t){t||(this.cards=this.origCards)}moveCard([t,e]){let i=this.cards[t];this.cards.splice(t,1),this.cards.splice(e,0,i)}tracker(t,e){return e.id}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=g({type:n,selectors:[["basic-sortable"]],decls:5,vars:0,consts:[[1,"sorted"],[3,"index","id","card"],[3,"card"],[4,"cardInner"],[3,"handleMove","beginDrag","endDrag","index","id","card"]],template:function(e,i){e&1&&(r(0,"dnd-preview"),p(1,oe,2,1,"ng-template"),o(),r(2,"div",0),w(3,de,2,3,"app-card",1,i.tracker,!0),o()),e&2&&(s(3),M(i.cards))},dependencies:[H,G,X,v],styles:[".sorted[_ngcontent-%COMP%]{max-width:400px}"]})}}return n})();var ce=()=>["/sortable","simple"],ee=(()=>{class n{static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=g({type:n,selectors:[["basic-sortable-container"]],decls:34,vars:2,consts:[["path","basic-sortable"],[3,"routerLink"]],template:function(e,i){e&1&&(C(0,"app-example-link",0),r(1,"p"),a(2,"You can make a sortable by:"),o(),r(3,"ul")(4,"li"),a(5,"giving each card a "),r(6,"code"),a(7,"DragSource"),o(),a(8," and a "),r(9,"code"),a(10,"DropTarget"),o(),a(11,";"),o(),r(12,"li"),a(13," determining when you are hovering on the upper or lower half of a neighbouring card using "),r(14,"code"),a(15,"monitor.getClientOffset()"),o(),a(16,"; "),o(),r(17,"li"),a(18," working out when a reordering is necessary by comparing the index with the item in flight's index; "),o(),r(19,"li"),a(20," bubbling up reordering events, and also beginDrag, endDrag and drop events to a component that controls re-rendering the list; and "),o(),r(21,"li"),a(22,"storing a clone of your list to revert to on endDrag, or commit to on drop"),o()(),r(23,"p"),a(24," If that sounds like too much effort, this pattern is made easy and reusable in "),r(25,"code"),a(26,"@ng-dnd/sortable"),o(),a(27,". You can do it without introducing a new component, too. "),o(),r(28,"p"),a(29," You can compare the source code of this example to equivalent using that abstraction, "),r(30,"a",1),a(31,"Simple list"),o(),a(32,". "),o(),C(33,"basic-sortable")),e&2&&(s(30),l("routerLink",P(1,ce)))},dependencies:[q,K,Z],encapsulation:2})}}return n})();var ke=[{path:"",component:ee}];export{ke as routes};
