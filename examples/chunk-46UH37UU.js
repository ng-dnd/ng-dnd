import{$a as k,Bb as X,Cb as q,E as F,Ea as g,M as L,Mb as U,Ob as Y,Ra as B,Xb as G,Ya as A,Za as $,_a as p,a as u,ab as j,ea as R,gb as M,h as y,ja as a,kc as J,m as E,n as _,ob as N,pb as H,sa as h,tb as P,va as z,wb as Q,zb as V,zc as f}from"./chunk-C7W2QAC5.js";var x=function(i){return i.BeginDrag="BeginDrag",i.Hover="Hover",i.Drop="Drop",i.EndDrag="EndDrag",i}(x||{}),v=class{constructor(s,t){this.type=s,this.item=t,this.event=x.BeginDrag}},S=class{constructor(s,t){this.type=s,this.item=t,this.event=x.Hover}},w=class{constructor(s,t){this.type=s,this.item=t,this.event=x.Drop}},C=class{constructor(s,t){this.type=s,this.item=t,this.event=x.EndDrag}},K=class{constructor(s,t,e){this.store=s,this.actionType=t,this.beginDrag=(r,o)=>{this.store.dispatch(new v(this.actionType,r))},this.hover=(r,o)=>{this.store.dispatch(new S(this.actionType,r))},this.drop=(r,o)=>{this.store.dispatch(new w(this.actionType,r))},this.endDrag=(r,o)=>{this.store.dispatch(new C(this.actionType,r))},e.type!==void 0&&(this.type=e.type),e.accepts!==void 0&&(this.accepts=e.accepts),e.trackBy!==void 0&&(this.trackBy=e.trackBy),e.getList!==void 0&&(this.getList=e.getList),e.canDrag!==void 0&&(this.canDrag=e.canDrag),e.canDrop!==void 0&&(this.canDrop=e.canDrop),e.isDragging!==void 0&&(this.isDragging=e.isDragging),e.createData!==void 0&&(this.createData=e.createData)}};var et=Symbol("SPILLED_LIST_ID");function gt(i,s,t){let e=n=>n?(n.hover={listId:et,index:-1},u({},n)):null,r=new E,o=i.dropTarget(s,{hover:n=>{if(n.canDrop()&&n.isOver({shallow:!0})){let c=e(n.getItem());r.next(c)}else r.next(null)},drop:t.drop&&(n=>{let c=e(n.getItem());n.didDrop()||c&&t.drop?.(c)})||void 0}),d=r.pipe(L(),F(n=>!!n)).subscribe(n=>{n&&t.hover?.(n)});return o.add(d),o}function W(i){for(let s of i)return!1;return!0}var m=class{constructor(s,t){this.width=s,this.height=t}style(){return{width:this.width+"px",height:this.height+"px"}}},b=function(i){return i.halfway="halfway",i.fixed="fixed",i}(b||{});var T=(()=>{class i{constructor(){this.cdr=a(G),this.dnd=a(f),this.el=a(g),this.listId=Math.random().toString(),this.horizontal=!1,this.hoverTrigger=b.halfway,this.childrenSubject$=new _([]),this.children$=this.childrenSubject$,this.subs=new y,this.listSubs=new y,this.target=this.dnd.dropTarget(null,{canDrop:t=>{if(!this.acceptsType(t.getItemType()))return!1;let e=t.getItem();return e?this.getCanDrop(e,t):!1},drop:t=>{let e=t.getItem();return e&&this.getCanDrop(e,t)&&this.spec.drop?.(e,t),{}},hover:t=>{let e=t.getItem();this.children&&W(this.children)&&e&&this.getCanDrop(e,t)&&t.isOver({shallow:!0})&&this.callHover(e,t,{listId:this.listId,index:0})}},this.subs)}contextFor(t,e){return{data:t,index:e,listId:this.listId,spec:this.spec,horizontal:this.horizontal,hoverTrigger:this.hoverTrigger}}updateSubscription(){if(this.listId!=null&&this.spec&&(this.listSubs&&(this.subs.remove(this.listSubs),this.listSubs.unsubscribe()),this.spec.getList)){let t=this.spec.getList(this.listId);this.listSubs=t?.subscribe(e=>{e&&(this.childrenSubject$.next(e),this.children=e,this.cdr.markForCheck())}),this.subs.add(this.listSubs)}}getCanDrop(t,e,r=!0){return this.spec.canDrop?this.spec.canDrop(t,e):r}callHover(t,e,r){r&&(t.hover=r,t=u({},t)),this.spec.hover?.(t,e)}ngOnInit(){this.updateSubscription(),this.target.setTypes(this.getTargetType())}getTargetType(){return Array.isArray(this.spec.accepts)?this.spec.accepts:this.spec.accepts||this.spec.type}acceptsType(t){if(t==null)return!1;if(Array.isArray(this.spec.accepts))return this.spec.accepts.indexOf(t)!==-1;{let e=this.getTargetType();return t==e}}ngOnChanges({spec:t,listId:e}){e&&this.updateSubscription(),t&&this.updateSubscription(),this.target.setTypes(this.getTargetType())}ngAfterViewInit(){if(this.el)this.target.connectDropTarget(this.el.nativeElement);else throw new Error("dndSortable directive must have ElementRef")}ngOnDestroy(){this.subs.unsubscribe()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=p({type:i,selectors:[["","dndSortable",""]],inputs:{listId:"listId",horizontal:"horizontal",spec:"spec",children:"children",hoverTrigger:"hoverTrigger"},exportAs:["dndSortable"],features:[h]})}}return i})();var Z=Symbol("EXTERNAL_LIST_ID"),it=(()=>{class i{constructor(){this.dnd=a(f),this.el=a(g),this.source=this.dnd.dragSource(null,{canDrag:t=>this.spec.canDrag?this.spec.canDrag(void 0,void 0,t):!0,beginDrag:()=>{if(typeof this.spec.createData!="function")throw new Error("spec.createData must be a function");return{type:this.spec.type,data:this.spec.createData(),hover:{index:-1,listId:Z},isInternal:!1,index:-1,listId:Z,size:this.size()}},endDrag:t=>{let e=t.getItem();e&&this.spec.endDrag?.(e,t)}})}size(){let t=this.el.nativeElement.getBoundingClientRect();return new m(t.width||t.right-t.left,t.height||t.bottom-t.top)}ngOnChanges(){this.source.setType(this.spec.type)}ngOnDestroy(){this.source.unsubscribe()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=p({type:i,selectors:[["","dndSortableExternal",""]],inputs:{spec:[0,"dndSortableExternal","spec"]},exportAs:["dndSortableExternal"],features:[h]})}}return i})();var O=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=p({type:i,selectors:[["","dndSortableTemplate",""]]})}}return i})();var rt=i=>({$implicit:i});function st(i,s){i&1&&P(0)}function nt(i,s){if(i&1&&j(0,st,1,0,"ng-container",0),i&2){let t=s.$implicit,e=s.$index,r=Q();M("ngTemplateOutlet",r.template)("ngTemplateOutletContext",Y(2,rt,r.contextFor(t,e)))}}var ot=(()=>{class i extends T{constructor(){super(...arguments),this.template=null,this.trackById=(t,e)=>this.spec.trackBy(e)}set renderTemplates(t){t.length>0&&(this.template=t.first)}ngAfterContentInit(){if(!this.template)throw new Error('You must provide a <ng-template cardTemplate> as a content child, or with [template]="myTemplateRef"')}ngOnChanges(t){super.ngOnChanges(t)}ngOnInit(){super.ngOnInit()}ngAfterViewInit(){super.ngAfterViewInit()}ngOnDestroy(){super.ngOnDestroy()}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=z(i)))(r||i)}})()}static{this.\u0275cmp=A({type:i,selectors:[["dnd-sortable-list"]],contentQueries:function(e,r,o){if(e&1&&V(o,O,4,B),e&2){let D;X(D=q())&&(r.renderTemplates=D)}},inputs:{template:"template"},features:[U([{provide:T,useExisting:i}]),k,h],decls:2,vars:0,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,r){e&1&&N(0,nt,1,4,"ng-container",null,r.trackById,!0),e&2&&H(r.children)},dependencies:[J],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}}return i})();function at(i,s,t,e){let{hover:r}=s,o=i.horizontal?t.width||t.right-t.left:t.height||t.bottom-t.top,d=(i.horizontal?t.left:t.top)+o/2,c=(i.horizontal?e.x:e.y)<d,l;return i.listId===r.listId?i.index<r.index?l=c?i.index:i.index+1:(l=c?i.index-1:i.index,l<0&&(l=0)):l=c?i.index:i.index+1,l}function ct(i){return i.index}function tt(i){switch(i){case b.fixed:return ct;default:return at}}var ht=requestAnimationFrame||(i=>setTimeout(i,0)),pt=(()=>{class i{get data(){return this.context.data}get index(){return this.context.index}get type(){return this.context.spec.type}get listId(){return this.context.listId}get accepts(){let t=this.context.spec;return t?Array.isArray(t.accepts)?t.accepts:t.accepts||t.type:[]}get spec(){return this.context.spec}constructor(){this.dnd=a(f),this.el=a(g),this.subs=new y,this.sameIds=(t,e)=>t&&e.data&&this.spec.trackBy(t)===this.spec.trackBy(e.data),this.target=this.dnd.dropTarget(null,{canDrop:()=>!1,hover:t=>{this.hover(t)}},this.subs),this.source=this.dnd.dragSource(null,{canDrag:t=>this.getCanDrag(t),isDragging:t=>this.isDragging(t.getItem()),beginDrag:t=>{let e=this.createItem();return this.spec.beginDrag&&ht(()=>{this.spec.beginDrag?.(e,t)}),e},endDrag:t=>{let e=t.getItem();e&&this.spec.endDrag?.(e,t)}},this.subs),this.isDragging$=this.source.listen(t=>t.isDragging())}createItem(){return{data:this.data,index:this.index,size:this.size(),type:this.type,isInternal:!0,listId:this.listId,hover:{index:this.index,listId:this.listId}}}getCanDrag(t){return this.spec.canDrag?this.spec.canDrag(this.data,this.listId,t):!0}isDragging(t){return this.spec.isDragging?t&&this.spec.isDragging(this.data,t)||!1:t&&this.sameIds(this.data,t)||!1}hover(t){let e=t.getItem(),r=t.getClientOffset();if(e==null||r==null||this.isDragging(e)&&this.index===e.hover.index&&this.listId===e.hover.listId)return;let{hover:o}=e,d=tt(this.context.hoverTrigger)(this.context,e,this.rect(),r);if(d<0)throw new Error("@ng-dnd/sortable: Cannot move a card to an index < 0.");if(d!==o.index||this.listId!==o.listId){if(e.hover={index:d,listId:this.listId},this.spec.canDrop&&!this.spec.canDrop(e,t))return;this.spec.hover?.(u({},e),t)}}rect(){if(!this.el)throw new Error("@ng-dnd/sortable: [dndSortableRender] expected to be attached to a real DOM element");return this.el.nativeElement.getBoundingClientRect()}size(){let t=this.rect(),e=t.width||t.right-t.left,r=t.height||t.bottom-t.top;return new m(e,r)}ngOnChanges(){this.target.setTypes(this.accepts),this.source.setType(this.type)}ngOnInit(){this.target.setTypes(this.accepts),this.source.setType(this.type)}ngAfterViewInit(){this.el&&this.target.connectDropTarget(this.el.nativeElement)}ngOnDestroy(){this.subs.unsubscribe()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=p({type:i,selectors:[["","dndSortableRender",""]],inputs:{context:[0,"dndSortableRender","context"]},exportAs:["dndSortableRender"],features:[h]})}}return i})();var oe=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=$({type:i})}static{this.\u0275inj=R({})}}return i})();export{b as a,T as b,it as c,O as d,ot as e,pt as f,x as g,K as h,gt as i,oe as j};
